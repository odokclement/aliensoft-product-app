import{C as j,r as p,u as P,j as S,D as n}from"./index-DTV4gXJZ.js";const F=j("products",()=>{const u=p([]),s=p(!1),a=p(null),c=p(null),i=P(),l=()=>({Authorization:`Bearer ${i.token}`}),v=async(t="",e="")=>{s.value=!0,a.value=null;try{let r="https://dummyjson.com/products";const o=new URLSearchParams;t&&o.append("q",t),e&&o.append("category",e),o.toString()&&(r+=`/search?${o.toString()}`);const d=await n.get(r,{headers:l()});return u.value=d.data.products,{success:!0,data:d.data}}catch(r){return a.value=r.response?.data?.message||"Failed to fetch products",{success:!1,error:a.value}}finally{s.value=!1}},f=async t=>{s.value=!0,a.value=null;try{const e=await n.get(`https://dummyjson.com/products/${t}`,{headers:l()});return c.value=e.data,{success:!0,data:e.data}}catch(e){return a.value=e.response?.data?.message||"Failed to fetch product",{success:!1,error:a.value}}finally{s.value=!1}},m=async t=>{s.value=!0,a.value=null;try{const e=await n.post("https://dummyjson.com/products/add",t,{headers:{...l(),"Content-Type":"application/json"}});return u.value.unshift(e.data),{success:!0,data:e.data}}catch(e){return a.value=e.response?.data?.message||"Failed to add product",{success:!1,error:a.value}}finally{s.value=!1}},h=async(t,e)=>{s.value=!0,a.value=null;try{const r=await n.put(`https://dummyjson.com/products/${t}`,e,{headers:{...l(),"Content-Type":"application/json"}}),o=u.value.findIndex(d=>d.id===t);return o!==-1&&(u.value[o]=r.data),c.value&&c.value.id===t&&(c.value=r.data),{success:!0,data:r.data}}catch(r){return a.value=r.response?.data?.message||"Failed to update product",{success:!1,error:a.value}}finally{s.value=!1}},y=async t=>{s.value=!0,a.value=null;try{return await n.delete(`https://dummyjson.com/products/${t}`,{headers:l()}),u.value=u.value.filter(e=>e.id!==t),{success:!0}}catch(e){return a.value=e.response?.data?.message||"Failed to delete product",{success:!1,error:a.value}}finally{s.value=!1}},g=S(()=>{const t=u.value.map(e=>e.category);return[...new Set(t)]});return{products:u,isLoading:s,error:a,currentProduct:c,categories:g,fetchProducts:v,fetchProductById:f,addProduct:m,updateProduct:h,deleteProduct:y}});export{F as u};
